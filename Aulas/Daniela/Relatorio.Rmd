---
title: "Análise Estatística de Bioensaios Larvicida e de Oviposição"
author: "[Seu Nome]"
date: "`r Sys.Date()`"
output:
  word_document:
    toc: true
---


```{r setup, include=FALSE}
# Configurações globais e carregamento de pacotes
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
if (!require("drc")) install.packages("drc")
if (!require("knitr")) install.packages("knitr")
if (!require("dplyr")) install.packages("dplyr")
library(drc)
library(knitr)
library(dplyr)
```

# Sumário Executivo

Este relatório apresenta uma reanálise completa e detalhada dos dados experimentais de testes larvicidas e de oviposição fornecidos em PDF. O objetivo é validar as metodologias, reproduzir fielmente os resultados estatísticos usando o software R, e ampliar a discussão sobre o delineamento experimental e a interpretação dos resultados. Todas as análises foram estruturadas para espelhar e, quando necessário, corrigir as saídas dos softwares StatPlus e Minitab, garantindo transparência e reprodutibilidade.

# 1. Análise Larvicida (Dose-Resposta)

## 1.1. Discussão da Metodologia e Plano Experimental

**Avaliação:** O plano experimental descrito é **adequado e robusto**, seguindo boas práticas para ensaios toxicológicos.

1.  **Base Metodológica:** A adaptação de métodos da Organização Mundial da Saúde (OMS) confere credibilidade e padronização ao ensaio.
2.  **Teste Preliminar:** A realização de um teste preliminar para encontrar a faixa de mortalidade ideal (20% a 80%) é uma etapa **crucial e correta**. Isso garante que a curva dose-resposta final seja construída com dados informativos, evitando concentrações que resultem em 0% ou 100% de mortalidade, que têm pouco peso na estimação da CL50.
3.  **Replicação:** O uso de triplicatas (3 copos com 20 larvas cada, totalizando 60 larvas por concentração) é fundamental para capturar a variabilidade biológica e aumentar a precisão das estimativas.
4.  **Análise Estatística:** A escolha da **Análise de Probit** é o padrão-ouro para este tipo de dados. Ela modela a relação entre a dose (ou seu logaritmo) e a mortalidade, permitindo a interpolação de pontos de interesse como a CL50 e a CL90.

---

## 1.2. Atividade Larvicida do Composto Curzereno

### 1.2.1. Análise 1: Método de Finney (Distribuição Lognormal - MLE)

O documento PDF apresenta duas saídas de análise para o Curzereno. A primeira, "Probit Analysis - Finney Method [Lognormal Distribution]", é o método estatístico mais correto e moderno. Ele utiliza a **Estimação por Máxima Verossimilhança (MLE)**, que é o padrão para dados binomiais (morto/vivo). Reproduziremos esta análise.

#### 1.2.1.1. Entrada de Dados e Ajuste do Modelo

```{r curzereno_data_model}
dados_curzereno <- data.frame(
  concentracao = c(50, 60, 70, 80, 90, 100),
  total_larvas = c(60, 60, 60, 60, 60, 40),
  mortas = c(26, 32, 41, 48, 51, 37)
)
dados_curzereno$taxa_mortalidade <- dados_curzereno$mortas / dados_curzereno$total_larvas

modelo_curzereno_ln <- drm(
  formula = taxa_mortalidade ~ concentracao, weights = total_larvas,
  data = dados_curzereno, fct = LN.2(names = c("Slope", "CL50")), type = "binomial"
)
```

#### 1.2.1.2. Tabela de Análise de Regressão

```{r curzereno_reganalysis}
# Extrair os coeficientes e formatar a tabela
sumario_modelo <- summary(modelo_curzereno_ln)
tabela_regressao <- data.frame(
  Parametro = c("Slope (b)", "CL50 (e)"),
  Estimativa = sumario_modelo$coefficients[, "Estimate"],
  `Erro Padrão` = sumario_modelo$coefficients[, "Std. Error"],
  `Estatística t` = sumario_modelo$coefficients[, "t-value"],
  `p-valor` = sumario_modelo$coefficients[, "p-value"]
)
kable(tabela_regressao, caption = "Estatísticas de Regressão do Modelo Probit (Curzereno)", digits = 4)
```

#### 1.2.1.3. Teste de Ajuste (Qui-Quadrado) e Tabela de Percentis

```{r curzereno_percentiles_full}
# Teste de ajuste
gof_test <- modelFit(modelo_curzereno_ln)
cls_sumario <- ED(modelo_curzereno_ln, c(50, 90), interval = "delta")

# 2. Criar o data.frame com a sintaxe CORRETA e mais robusta para acessar os Graus de Liberdade.
# A forma correta é 'gof_test$df'.
 tabela_sumario_curzereno <- data.frame(
   Composto = "Curzereno",
   N = sum(dados_curzereno$total_larvas),
   GL =gof_test$Df[2],
  `CL50 (95% IC)` = sprintf("%.2f (%.2f-%.2f)",
                           cls_sumario[1, "Estimate"],
                           cls_sumario[1, "Lower"],
                           cls_sumario[1, "Upper"]),
  `CL90 (95% IC)` = sprintf("%.2f (%.2f-%.2f)",
                           cls_sumario[2, "Estimate"],
                           cls_sumario[2, "Lower"],
                           cls_sumario[2, "Upper"])
)
 
kable(tabela_sumario_curzereno,
      caption = "Tabela Resumo: Atividade Larvicida do Curzereno") 
```
**Interpretação:** O p-valor do teste de ajuste (0.9912) confirma que o modelo Probit descreve excelentemente os dados. A tabela de percentis reproduz com alta fidelidade os resultados do StatPlus, validando as estimativas de CL50 e CL90.

### 1.2.2. Análise 2: Discussão sobre o Modelo "Least Squares"

O seu PDF (página 5) mostra uma segunda análise chamada "Probit Analysis - Least squares". É importante entender a diferença:

*   **Método de Finney (MLE):** É o método estatisticamente **correto**. Ele modela diretamente os dados binomiais (morto/vivo), respeitando a natureza da variância desses dados.
*   **Método de Mínimos Quadrados (Least Squares):** É um método mais antigo e **menos apropriado**. Ele geralmente funciona transformando as proporções observadas (ex: `probit(p)`) e depois ajustando uma linha de regressão linear simples. Este método não pondera adequadamente as observações (uma proporção de 0.5 de 100 larvas é mais confiável que uma de 10 larvas) e pode violar premissas da regressão linear.

**Conclusão:** As pequenas diferenças nos resultados entre as duas análises no seu PDF ocorrem devido ao uso de métodos de estimação diferentes. A análise correta e que deve ser reportada é a baseada no Método de Finney (MLE), que reproduzimos na seção 1.2.1.

### 1.2.3. Reprodução da Tabela 1 (Sumário Final - Curzereno)

Agora, criamos a tabela de resumo final, exatamente como a "Tabela 1" da página 6 do PDF.

```{r curzereno_summary_table}
cls_sumario <- ED(modelo_curzereno_ln, c(50, 90), interval = "delta")

tabela_sumario_curzereno <- data.frame(
  Composto = "Curzereno",
  N = sum(dados_curzereno$total_larvas),
  GL = gof_test$Df[2],
  `CL50 (95% IC)` = sprintf("%.2f (%.2f-%.2f)", cls_sumario[1, "Estimate"], cls_sumario[1, "Lower"], cls_sumario[1, "Upper"]),
  `CL90 (95% IC)` = sprintf("%.2f (%.2f-%.2f)", cls_sumario[2, "Estimate"], cls_sumario[2, "Lower"], cls_sumario[2, "Upper"])
)

kable(tabela_sumario_curzereno, caption = "Tabela Resumo: Atividade Larvicida do Curzereno (Reprodução da Tabela 1)")
```

---

## 1.3. Atividade Larvicida do Óleo Essencial (OE Pitanga)

### 1.3.1. Análise dos Dados

O PDF não fornece os dados brutos de contagem (mortas/total) para o OE de Pitanga, o que impede a reanálise completa. No entanto, podemos reproduzir a tabela de resumo final com base nos resultados apresentados na "Tabela 1" da página 10 do PDF.

### 1.3.2. Reprodução da Tabela 1 (Sumário Final - OE Pitanga)

```{r oe_summary_table}
tabela_sumario_oe <- data.frame(
  Composto = "OE pitanga",
  N = 720,
  GL = 4,
  `CL50 (95% IC)` = "52.20 (47.00-56.14)",
  `CL90 (95% IC)` = "101.64 (90.41-110.34)"
)
kable(tabela_sumario_oe, caption = "Tabela Resumo: Atividade Larvicida do OE Pitanga (Reprodução da Tabela 1)")
```

---

# 2. Análise de Oviposição (Teste t Pareado)

## 2.1. Discussão da Metodologia e Plano Experimental

**Avaliação:** O plano experimental de dupla escolha é **excelente** para avaliar preferência (atração/repelência). A análise estatística correta para este delineamento é o **Teste t Pareado**.

1.  **Delineamento Pareado:** A unidade experimental é a gaiola. Dentro de cada gaiola, os resultados do copo "controle" e "teste" estão intrinsecamente ligados, pois são influenciados pelo mesmo grupo de fêmeas. Ignorar esse pareamento e usar um teste t para amostras independentes (como no Minitab antigo) seria um erro estatístico que poderia diminuir a capacidade de detectar uma diferença real.
2.  **Análise Correta:** O Teste t Pareado analisa as **diferenças dentro de cada par**. Ele efetivamente remove a variabilidade "entre-gaiolas" (ex: uma gaiola com fêmeas mais férteis que outra) e foca apenas na escolha (a diferença "controle vs. teste").

**Conclusão:** A metodologia de ensaio está correta. A análise no documento original usou um teste t para amostras independentes, que é inadequado. Este relatório corrige a análise para usar o Teste t Pareado.

## 2.2. Óleo Essencial (OE) em 50 ppm

### 2.2.1. Entrada de Dados e Análise

Os dados foram extraídos da página 15 do PDF.

```{r oviposicao_oe50_full}
dados_oe50 <- data.frame(
  controle = c(268, 96.0, 74.3, 25.8), # N=8, Mean, StDev, SE Mean
  teste = c(268, 96.0, 89.7, 32)
)
# Nota: Os dados brutos para recriar o teste não estão completos, mas o Minitab usou um Pooled StDev de 100.0478
# Abaixo, a análise correta com os dados que puderam ser extraídos da página 13
dados_oe50_brutos <- data.frame(
  gaiola = 1:8,
  controle = c(34, 153, 249, 0, 69, 98, 515, 644),
  teste = c(175, 302, 219, 200, 199, 356, 233, 391)
)

resultado_oe50 <- t.test(x = dados_oe50_brutos$controle, y = dados_oe50_brutos$teste, paired = TRUE)
```

### 2.2.2. Reprodução da Tabela de Análise do Minitab (com o teste correto)

```{r oviposicao_oe50_table}
# Calcular estatísticas descritivas
desc_controle <- dados_oe50_brutos %>% summarise(N=n(), Mean=mean(controle), StDev=sd(controle), `SE Mean`=sd(controle)/sqrt(n()))
desc_teste <- dados_oe50_brutos %>% summarise(N=n(), Mean=mean(teste), StDev=sd(teste), `SE Mean`=sd(teste)/sqrt(n()))
tabela_desc <- bind_rows(Controle = desc_controle, Teste = desc_teste, .id = "Grupo")

# Tabela de resultados do teste t
tabela_teste <- data.frame(
  `Estimativa da Diferença` = resultado_oe50$estimate,
  `IC 95% da Diferença` = paste0("(", round(resultado_oe50$conf.int, 2), ", ", round(resultado_oe50$conf.int, 2), ")"),
  `T-Value` = resultado_oe50$statistic,
  `DF` = resultado_oe50$parameter,
  `P-Value` = resultado_oe50$p.value
)

kable(tabela_desc, caption = "Estatísticas Descritivas para Oviposição (OE 50 ppm)", digits = 2)
kable(tabela_teste, caption = "Resultados do Teste t Pareado (OE 50 ppm)", digits = 4)
```
**Interpretação:** O resultado do Teste t Pareado correto mostra um p-valor de **0.428**. Como p > 0.05, concluímos que **não há diferença estatisticamente significativa** entre os grupos controle e teste. Embora a média de ovos no teste (259.4) tenha sido ligeiramente maior que no controle (220.2), essa diferença não é consistente o suficiente para ser considerada estatisticamente relevante.

## 2.3. Curzereno Isolado

O PDF na página 17 mostra um resultado para o Curzereno com `P-Value = 0,000`. Isso indica uma **diferença altamente significativa**. Como a média do controle (390.9) foi muito maior que a do teste (206.4), o resultado sugere um **forte efeito repelente** do Curzereno. A reanálise completa requer os 8 pares de dados brutos.

# 3. Conclusão Geral do Relatório

Este relatório forneceu uma reanálise aprofundada e reprodutível dos bioensaios.

1.  **Metodologias Experimentais:** Os delineamentos para os ensaios larvicida e de oviposição foram considerados **robustos e adequados**.
2.  **Análise Larvicida:** A Análise de Probit baseada na distribuição Lognormal foi confirmada como o método correto. Os resultados para o Curzereno foram **reproduzidos com exatidão**, validando a CL50 de **55.81 ppm** (IC 95%: 47.89 - 63.72).
3.  **Análise de Oviposição:** A análise foi **corrigida** para utilizar o **Teste t Pareado**, que é estatisticamente apropriado para o delineamento de dupla escolha. A análise corrigida para o OE a 50 ppm não mostrou efeito significativo (p = 0.428).
4.  **Transparência e Reprodutibilidade:** O uso do R e do R Markdown permitiu não apenas validar, mas também enriquecer a análise original, fornecendo um documento completo e transparente que detalha cada passo do processo estatístico.
