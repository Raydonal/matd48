---
title: "Fundamentos de Análise para Planejamento Experimental"
subtitle: "Populações Conceituais de
Respostas e modelos lineares"
author: "Raydonal Ospina"
output:
  xaringan::moon_reader:
    css: ["default", "metropolis", "metropolis-fonts", "custom-styles.css"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
bibliography: refs.bib
csl: apa.csl    
link-citations: true
---


```{r setup, include=FALSE}
# Opções globais do Knitr
options(html.tag.transform.rmarkdown = function(x) x)
knitr::opts_chunk$set(echo = TRUE, fig.align = 'center', message = FALSE, warning = FALSE, fig.width=8, fig.height=4.5)

# Carregar pacotes necessários
library(ggplot2)
library(dplyr)
library(MASS) # Para a função ginv()
library(DiagrammeR)
library(sf)
library(tidyverse)
```

class: center, middle, inverse

# Populações Conceituais de Respostas
---

## Populações Conceituais de Respostas


Em planejamento de experimentos, a concepção de uma **população conceitual de respostas** é bastante útil e natural.

Considere $Y_{ij}$ ($i=1,...,t$, $j=1,...,N$) como o valor **potencial** observado da variável resposta Y referente ao $j$-ésimo elemento da população, se ele fosse submetido ao tratamento $i$.

**Exemplo:** Como cada elemento da população é submetido ao efeito de apenas um dos tratamentos, tem-se, por exemplo, que o elemento `j` submetido ao tratamento `1` fornecerá a resposta $Y_{1j}$. Sendo este o caso, o valor $Y_{2j}$, por exemplo, não será observado, embora ele exista conceitualmente (se o tratamento escolhido para ser aplicado ao elemento `j` tivesse sido o de número 2, $Y_{2j}$ seria o valor observado).

---
### Definição e Estrutura da População Conceitual

A **população conceitual de respostas** desse experimento é definida como o conjunto $\{Y_{ij}\}$ de todas as possíveis respostas dos $N$ elementos que compõem a população sob o efeito de cada um dos $t$ tratamentos sob estudo.

O **Quadro ** a seguir ilustra a população conceitual de respostas em um experimento para comparar os efeitos de $t=2$ tratamentos ($i$ o tratamento) em uma população composta por $N=4$ elementos (unidades experimentais  (UE) como $j$).

| Tratamento | UE 1 | UE 2 | UE 3 | UE 4 | Total | Média |
|:----------:|:----:|:----:|:----:|:----:|:----:|:----:|
| **i=1**    | $Y_{11}$ | $Y_{12}$ | $Y_{13}$ | $Y_{14}$ | $Y_{1.}$ | $\bar{Y}_{1.}$ |
| **i=2**    | $Y_{21}$ | $Y_{22}$ | $Y_{23}$ | $Y_{24}$ | $Y_{2.}$ | $\bar{Y}_{2.}$ |
| Total      | ${Y}_{.1}$ | ${Y}_{.2}$| ${Y}_{.3}$| ${Y}_{.4}$| ${Y}_{...}$|         | 
| Média      | $\bar{Y}_{.1}$ | $\bar{Y}_{.2}$ | $\bar{Y}_{.3}$ | $\bar{Y}_{.4}$ |   | $\bar{Y}_{..}$ |

---

Note a estrutura de classificação da população conceitual de respostas do Quadro é representada no diagrama de Hasse:

```{r, echo=FALSE}
grViz("
digraph fig6_corrected {
  rankdir=TB;
  node [shape=circle, style=filled, fillcolor=lightblue];
  edge [arrowhead=none];

  # Definir nós com nomes seguros
  mu [label='μ'];
  Tratamento [label='T'];
  Unidade [label='U'];
  epsilon [label='ε'];
  
  # Definir relações de cima para baixo
  mu -> Tratamento;
  mu -> Unidade;
  Tratamento -> epsilon;
  Unidade -> epsilon;
  
  {rank=same; Tratamento; Unidade;}
}")
```

Nesta estrutura, os fatores `Tratamento (T)` e `Unidade Experimental (U)` são **cruzados**. A identidade algébrica relacionada é:
$$Y_{ij} = \bar{Y}_{..} + (\bar{Y}_{i.} - \bar{Y}_{..}) + (\bar{Y}_{.j} - \bar{Y}_{..}) + (Y_{ij} - \bar{Y}_{i.} - \bar{Y}_{.j} + \bar{Y}_{..})$$
---

### Da População Conceitual para a Amostra Observada
Populações conceituais de respostas **não são observáveis como um todo**.

Uma vez atribuídos os tratamentos às unidades experimentais, apenas uma resposta por u.e. é observada. Esse conjunto de respostas observadas pode ser visto como uma **amostra** da população conceitual.

**Porém, a estrutura dessa amostra não é mais a mesma da população de onde ela foi selecionada.**

Tomando a mesma situação ilustrada no Quadro anterior, numa amostra, cada unidade experimental está **embutida** num tratamento.

A **Figura** a seguir ilustra a estrutura de classificação da amostra observada no experimento:
ndo o estilo do PDF original:
---

```{r, echo=FALSE}
# Definir um estilo padrão para todos os gráficos para evitar repetição
graph_attrs <- "
  rankdir=TB;
  node [shape=circle, style=filled, fillcolor=lightblue];
  edge [arrowhead=none];
"
```

**Estrutura de classificação da amostra observada no experimento**
```{r, echo=FALSE}
grViz(paste0("digraph {", graph_attrs, "
  mu [label='μ'];
  epsilon [label='ε'];
  mu -> T -> U -> epsilon;
}"))
```

A identidade algébrica relacionada a uma observação do experimento é:
$$y_{ir} = \bar{y}_{..} + (\bar{y}_{i.} - \bar{y}_{..}) + (y_{ir} - \bar{y}_{i.})$$
---

